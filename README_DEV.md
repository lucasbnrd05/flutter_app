# Developer Setup Guide - GreenWatch

This guide details the steps required to set up the GreenWatch local development environment after cloning the repository. Certain configurations, particularly API keys, are managed within the application's settings screen after user login and are stored securely per user using SharedPreferences.

## Prerequisites

Before you begin, ensure you have installed:

1.  **Flutter SDK:** Follow the official installation instructions at [flutter.dev](https://flutter.dev/docs/get-started/install).
2.  **A New York Times Developer Account:** You will need an API key enabled for the **Article Search API**. Create an account and an application at [https://developer.nytimes.com/](https://developer.nytimes.com/).
3.  **An OpenAQ Platform Account:** You will need an API key for accessing air quality data. Register and obtain a key at [https://openaq.org/](https://openaq.org/) (usually involves requesting one via their platform/contact).

## Initial Setup Steps

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/lucasbnrd05/flutter_app.git 
    cd flutter_app
    ```
    *(Note: Assurez-vous que l'URL du clone est correcte si elle a chang√©)*

2.  **Install Flutter Dependencies:**
    This command downloads all the necessary packages listed in `pubspec.yaml`.
    ```bash
    flutter pub get
    ```

3.  **Configure Firebase (if not already done for your environment):**
    This project uses Firebase for authentication. Follow the FlutterFire CLI instructions to configure the project for your target platforms (Android, iOS, Web): [FlutterFire Overview](https://firebase.google.com/docs/flutter/overview)
    This usually involves running `flutterfire configure` and selecting your Firebase project.

4.  **Run the Application and Configure API Keys:**
    API keys are **not** stored in the code repository for security. They must be entered into the application's Settings screen *after logging in*.

    *   Ensure you have a running device (emulator, simulator, or physical device) connected and recognized by Flutter (`flutter devices`).
    *   Run the application:
        ```bash
        flutter run
        ```
    *   **Log In:** Use the Google Sign-In option or create an account using Email/Password on the authentication screen (`/auth`). Accessing the Settings page requires a non-anonymous login.
    *   **Navigate to Settings:** Open the drawer menu and select "Settings".
    *   **Enter API Keys:**
        *   In the "New York Times (News)" section, paste the NYT API key you obtained.
        *   In the "OpenAQ (Air Quality)" section, paste the OpenAQ API key you obtained.
        *   Press the "Save" button for each key.
    *   The keys are now stored securely for your logged-in user account and will be used for subsequent API calls.

## Running the Application

Once the initial setup and API key configuration within the app are complete:

1.  Ensure you have a running device connected (`flutter devices`).
2.  Run the application from the project root:
    ```bash
    flutter run
    ```

## Project Structure Overview

*   `lib/`: Main application source code.
    *   `auth/`: Authentication related screens and logic (`auth_page.dart`).
    *   `models/`: Data structures (`article.dart`, `event.dart`, `latest_measurement.dart`).
    *   `services/`: Logic for interacting with external APIs and local database (`nyt_service.dart`, `air_quality_service.dart`, `auth_service.dart`, `database_helper.dart`, `settings_service.dart`).
    *   `ux_unit/`: Reusable UI components (`custom_drawer.dart`, `login_required_widget.dart`).
    *   `themes.dart`: Application themes (light and dark).
    *   `theme_provider.dart`: Manages theme state.
    *   `main.dart`: Application entry point.
    *   `home.dart`, `map.dart`, `settings.dart`, `data.dart`, `about.dart`, `event_detail_page.dart`: Main application screens/pages.
*   `assets/`: Static resources (images, fonts, etc.).
*   `firebase_options.dart`: Firebase configuration file (generated by FlutterFire).
*   `pubspec.yaml`: Project dependencies and metadata.

## Common Troubleshooting

*   **API Errors (e.g., 401 Unauthorized, 403 Forbidden, 429 Too Many Requests):**
    *   **NYT:** Double-check that the API key entered in the app's **Settings page** is correct and matches the one from the NYT Developer portal exactly. Ensure the "Article Search API" is enabled for your key. Check NYT rate limits.
    *   **OpenAQ:** Double-check that the API key entered in the app's **Settings page** is correct and active on the OpenAQ platform. Check OpenAQ rate limits.
*   **Login Required Message:** Ensure you are logged in with a Google or Email account (not anonymous) to access features like Settings or Data Reporting.
*   **Firebase Errors:** Ensure your Firebase project is correctly set up for the platform you are running on (Android `google-services.json`, iOS `GoogleService-Info.plist`, Web configuration). Run `flutterfire configure` again if needed. Check Firebase console settings (Authentication enabled, etc.).
*   **Network Errors:** Ensure your machine/device has an active internet connection.
*   **Dependency Issues:** If you encounter errors related to packages, try running:
    ```bash
    flutter clean
    flutter pub get
    ```
*   **App Fails to Launch:** Check the error logs in the console after running `flutter run`. Ensure your Flutter setup is correct (`flutter doctor`).

---